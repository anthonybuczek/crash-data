<html lang="en" ng-app>
<head>
    <title>Metro Crashes</title>
    <meta name="keywords" content="metro, crash, heatmap, leaflet, javascript, canvas, html5"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Greg Moulliet">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <link href="css/crash-data.css" rel="stylesheet">
    <link href="lib/bootstrap-css/css/bootstrap.min.css" rel="stylesheet">
    <link href="lib/bootstrap-css/css/bootstrap-responsive.min.css" rel="stylesheet">

    <script type="text/javascript">
        var testCanvas = document.createElement("canvas");
        if (!('getContext' in testCanvas))
        {
            alert('Your browser is not supported by the heatmap library.  I recommend using Google Chrome.  ' +
                    'This website will work in latest version of all major browsers: Chrome, Firefox, Safari and Internet Explorer.');
        }
    </script>
</head>
<body>
<div ng-controller="CrashController">
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="brand" href="index.html">Metro Crashes - Home</a>

                <div class="nav-collapse collapse">
                    <ul class="nav">
                        <li class="active"><a href="#">Crash Map</a></li>
                        <li><a href="datasets.html">Data Sets</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="container" id="containerDiv" >
        <div id="sideSettingsDiv" class="sideSettings oregonSideSettings">
            <div id="settingsButton">
                <button id="changeSettings" type="button" class="btn btn-info hide" data-toggle="collapse" data-target="#settingsTable">
                    Settings <span class="caret"></span>
                </button>
            </div>
            <div id="settingsTable" class="collapse hide">
                    <table cellpadding="2" class="table table-condensed table-bordered sideTable">
                        <tr>
                            <th>Vehicles:</th>
                            <td><div title="Show crashes involving only cars"><label for="Car"><input id="Car" type="checkbox" ng-model="settings.cars" ng-change="loadData()"> Cars Only</label> </div></td>
                            <td><div title="Show crashes involving a bicycle"> <label for="Bike"><input id="Bike" type="checkbox" ng-model='settings.bikes' ng-change="loadData()"> Bike(s)</label></div></td>
                            <td><div title="Show crashes involving a pedestrian"><label for="Ped"><input id="Ped" type="checkbox" ng-model='settings.peds' ng-change="loadData()"> Ped(s)</label> </div></td>
                        </tr>
                        <tr>
                            <th>Severity:</th>
                            <td><div title="Only show accidents with a fatality"><label for="Fatality"><input id="Fatality" type="checkbox" ng-model='settings.fatal' ng-change="loadData()"> Fatality</label></div>  </td>
                            <td><div title="Only show crashes with a severe injury"><label for="InjuryA"><input id="InjuryA" type="checkbox" ng-model='settings.injuryA' ng-change="loadData()"> Injury A</label></div>  </td>
                            <td><div title="Only show crashes with a moderate injury"><label for="InjuryB"><input id="InjuryB" type="checkbox" ng-model='settings.injuryB' ng-change="loadData()"> Injury B</label></div>  </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><div title="Only show crashes with a light injury"><label for="InjuryC"><input id="InjuryC" type="checkbox" ng-model='settings.injuryC' ng-change="loadData()"> Injury C</label></div>  </td>
                            <td><div title="Show crashes with only property damage"><label for="Property"><input id="Property" type="checkbox" ng-model='settings.property' ng-change="loadData()"> Property</label></div>  </td>
                            <td><div title="Only show crashes involving alcohol"><label for="Alcohol"><input id="Alcohol" type="checkbox" ng-model='settings.alcohol' ng-change="loadData()"> Alcohol</label></div></td>

                        </tr>
                        <tr>
                            <th>Light:</th>
                            <td><label for="Day"><input id="Day" type="checkbox" ng-model='settings.day' ng-change="loadData()"> Day</label>  </td>
                            <td><label for="Night"><input id="Night" type="checkbox" ng-model='settings.night' ng-change="loadData()"> Night</label>  </td>
                            <td><label for="Twilight"><input id="Twilight" type="checkbox" ng-model='settings.twilight' ng-change="loadData()"> Twilight</label>  </td>
                        </tr>
                        <tr>
                            <th>Surface:</th>
                            <td><label for="Dry"><input id="Dry" type="checkbox" ng-model='settings.dry' ng-change="loadData()"> Dry</label>  </td>
                            <td><label for="Wet"><input id="Wet" type="checkbox" ng-model='settings.wet' ng-change="loadData()"> Wet</label>  </td>
                            <td><label for="Snow"><input id="Snow" type="checkbox" ng-model='settings.snowIce' ng-change="loadData()"> Snow/Ice</label>  </td>
                        </tr>
                        <tr>
                            <th>Years:</th>
                            <td><label for="2007"><input id="2007" type="checkbox" ng-model='settings.y2007' ng-change="loadData()"> 2007</label></td>
                            <td><label for="2008"><input id="2008" type="checkbox" ng-model='settings.y2008' ng-change="loadData()"> 2008</label></td>
                            <td><label for="2009"><input id="2009" type="checkbox" ng-model='settings.y2009' ng-change="loadData()"> 2009</label></td>
                        </tr>
                        <tr>
                            <td><label for="2010"><input id="2010" type="checkbox" ng-model='settings.y2010' ng-change="loadData()"> 2010</label></td>
                            <td><label for="2011"><input id="2011" type="checkbox" ng-model='settings.y2011' ng-change="loadData()"> 2011</label></td>
                            <td><label for="2012"><input id="2012" type="checkbox" ng-model='settings.y2012' ng-change="loadData()"> 2012</label></td>
                            <td><label for="2013"><input id="2013" type="checkbox" ng-model='settings.y2013'
                                                         ng-change="loadData()"> 2013</label></td>
                        </tr>
                        <tr>
                            <th>Collision</th>
                            <td><label for="angle"><input id="angle" type="checkbox" ng-model='settings.angle' ng-change="loadData()"> Angle</label></td>
                            <td><label for="headOn"><input id="headOn" type="checkbox" ng-model='settings.headOn' ng-change="loadData()"> Head On</label></td>
                            <td><label for="rearEnd"><input id="rearEnd" type="checkbox" ng-model='settings.rearEnd' ng-change="loadData()"> Rear End</label></td>
                        </tr>
                        <tr>
                            <th>Type:</th>
                            <td><label for="sideSwipe"><input id="sideSwipe" type="checkbox" ng-model='settings.sideSwipe' ng-change="loadData()"> Side Swipe</label></td>
                            <td><label for="turning"><input id="turning" type="checkbox" ng-model='settings.turning' ng-change="loadData()"> Turning</label></td>
                            <td><label for="other"><input id="other" type="checkbox" ng-model='settings.other' ng-change="loadData()"> Other</label></td>
                        </tr>
                        <tr>
                            <th>Scale:</th>
                            <td><label for="viewport"><input id="viewport" type="radio" value="Viewport" ng-model='settings.scale' ng-change="loadData()"> Viewport</label></td>
                            <td><label for="regional"><input id="regional" type="radio" value="Regional" ng-model='settings.scale' ng-change="loadData()"> Regional</label></td>
                            <td><label for="sinks"><input id="sinks" type="checkbox" ng-model='settings.sinks' ng-change="loadData()"> Sinks</label></td>
                        </tr>
                    </table>
            </div>
            <div id="summaryButton">
                <button id="summary" type="button" class="btn btn-info hide" data-toggle="collapse" data-target="#summaryTable">
                    Summary <span class="caret"></span>
                </button>
            </div>
            <div id="summaryTable" class="collapse hide settingsDiv">
                <table class="table table-condensed table-bordered sideTable">
                    <tr>
                        <td colspan="3">Total {{settings.scale}} Crashes</td>
                        <td colspan="3">{{total}}</td>
                    </tr>
                    <tr>
                        <td>Cars</td><td>{{summary.cars}}</td>
                        <td>Bikes</td><td>{{summary.bikes}}</td>
                        <td>Peds</td><td>{{summary.peds}}</td>
                    </tr>
                    <tr>
                        <td>Fatality</td><td>{{summary.fatal}}</td>
                        <td>Injury A</td><td>{{summary.injuryA}}</td>
                        <td>Injury B</td><td>{{summary.injuryB}}</td>
                    </tr>
                    <tr>
                        <td>Injury C</td><td>{{summary.injuryC}}</td>
                        <td>Property</td><td>{{summary.property}}</td>
                        <td>Alcohol</td><td>{{summary.alcohol}}</td>
                    </tr>
                    <tr>
                        <td>Day</td><td>{{summary.day}}</td>
                        <td>Night</td><td>{{summary.night}}</td>
                        <td>Twilight</td><td>{{summary.twilight}}</td>
                    </tr>
                    <tr>
                        <td>Dry</td><td>{{summary.dry}}</td>
                        <td>Wet</td><td>{{summary.wet}}</td>
                        <td>Snow/Ice</td><td>{{summary.snowIce}}</td>
                    </tr>
                    <tr>
                        <td>Angle</td><td>{{summary.angle}}</td>
                        <td>Head On</td><td>{{summary.headOn}}</td>
                        <td>Rear End</td><td>{{summary.rearEnd}}</td>
                    </tr>
                    <tr>
                        <td>Side Swipe</td><td>{{summary.sideSwipe}}</td>
                        <td>Turning</td><td>{{summary.turning}}</td>
                        <td>Other</td><td>{{summary.other}}</td>
                    </tr>
                </table>
            </div>
        </div>
        <div id="refreshDiv" class="refreshDiv well hidden"></div>
        <div id ='legend' class="legend legend-area">
            <h4>Crash Count</h4>
            <span id="min"></span>
            <span id="max"></span>
            <img id="gradient" src="" style="width:100%" />
        </div>
        <div id="buttons">
            <button id='btnRoad'>Road</button>
            <button id='btnPhoto'>Air Photo</button>
        </div>
    </div>
    </div>
</div>

<div id="main">
    <div id="heatmapArea" class="heatmapArea"></div>
</div>
<script type="text/javascript" src="lib/angular/angular.min.js"></script>
<script type="text/javascript" src="lib/heatmap.js/build/heatmap.js"></script>
<script type="text/javascript" src="lib/heatmap.js/plugins/leaflet-heatmap.js"></script>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/bootstrap-css/js/bootstrap.js"></script>
<script type="text/javascript" src="js/settings.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="js/crashes.js"></script>

</body>
</html>
